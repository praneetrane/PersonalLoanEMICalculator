<html>

<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
        crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.5.0-rc2/knockout-min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="Calculator.css">
</head>

<body>
    <div id="DIV_1">
        <div id="DIV_2">
            <div id="DIV_3">
                <div id="DIV_4">
                    <h4 id="H4_5">
                        <a id="A_6">Personal Loan EMI Calculator</a>
                    </h4>
                </div>
                <div id="DIV_7">
                    <div id="DIV_8">
                        <div id="DIV_9">
                            <div id="DIV_10">
                                <div id="DIV_11">
                                    <div id="DIV_12">
                                        <div id="DIV_13">
                                            <div id="DIV_14">
                                                <div id="DIV_15">
                                                    <div id="DIV_16">
                                                        Loan Amount<span id="SPAN_17"><input type="text" id="INPUT_18"
                                                                data-bind="value: sliderLoanAmountRounded" />INR</span>
                                                    </div>
                                                    <div id="DIV_19">
                                                        <!--       <div id="DIV_20">
                                                                        <div id="DIV_21">
                                                                        </div>
                                                                        <div id="DIV_22">
                                                                        </div>
                                                                        <div id="DIV_23">
                                                                        </div>
                                                                    </div>
                                                                    <div id="DIV_24">
                                                                        <div id="DIV_25">
                                                                        </div>
                                                                        <div id="DIV_26">
                                                                        </div>
                                                                    </div>
                                                                    <div id="DIV_27">
                                                                        <div id="DIV_28">
                                                                        </div>
                                                                        <div id="DIV_29">
                                                                        </div>
                                                                    </div>
                                                                    <div id="DIV_30">
                                                                        <div id="DIV_31">
                                                                        </div>
                                                                        <div id="DIV_32">
                                                                        </div>
                                                                    </div>
                                                                    <div id="DIV_33">
                                                                    </div>
                                                                    <div id="DIV_34">
                                                                    </div> -->
                                                        <!-- Loan Amount<span id="SPAN_17"><input type="text" id="INPUT_18" data-bind="text: SliderLoanAmount" />INR</span> -->
                                                        <input type="range" min="100000" max="2500000" class="slider"
                                                            id="rangeLoanAmount" data-bind="value: sliderLoanAmount, valueUpdate: 'input'">
                                                    </div>
                                                    <input id="INPUT_35" type="text" value="100000" />
                                                    <div id="DIV_36">
                                                        Tenor<span id="SPAN_37"><input type="number" id="INPUT_38"
                                                                data-bind="value:sliderTenor " />Months</span>
                                                    </div>
                                                    <div id="DIV_39">
                                                        <!-- <div id="DIV_40">
                                                                        <div id="DIV_41">
                                                                        </div>
                                                                        <div id="DIV_42">
                                                                        </div>
                                                                        <div id="DIV_43">
                                                                        </div>
                                                                    </div>
                                                                    <div id="DIV_44">
                                                                        <div id="DIV_45">
                                                                        </div>
                                                                        <div id="DIV_46">
                                                                        </div>
                                                                    </div>
                                                                    <div id="DIV_47">
                                                                        <div id="DIV_48">
                                                                        </div>
                                                                        <div id="DIV_49">
                                                                        </div>
                                                                    </div>
                                                                    <div id="DIV_50">
                                                                        <div id="DIV_51">
                                                                        </div>
                                                                        <div id="DIV_52">
                                                                        </div>
                                                                    </div>
                                                                    <div id="DIV_53">
                                                                    </div>
                                                                    <div id="DIV_54">
                                                                    </div> -->
                                                        <input type="range" min="1" max="60" class="slider" id="rangeTenor"
                                                            data-bind="value: sliderTenor, valueUpdate: 'input' ">
                                                    </div>
                                                    <input id="INPUT_55" type="text" value="1" />
                                                    <div id="DIV_56">
                                                        Rate of Interest<span id="SPAN_57"><input type="number" id="INPUT_58"
                                                                data-bind="value: sliderRateofInterest" />Percent</span>
                                                    </div>
                                                    <div id="DIV_59">
                                                        <!-- <div id="DIV_60">
                                                                        <div id="DIV_61">
                                                                        </div>
                                                                        <div id="DIV_62">
                                                                        </div>
                                                                        <div id="DIV_63">
                                                                        </div>
                                                                    </div>
                                                                    <div id="DIV_64">
                                                                        <div id="DIV_65">
                                                                        </div>
                                                                        <div id="DIV_66">
                                                                        </div>
                                                                    </div>
                                                                    <div id="DIV_67">
                                                                        <div id="DIV_68">
                                                                        </div>
                                                                        <div id="DIV_69">
                                                                        </div>
                                                                    </div>
                                                                    <div id="DIV_70">
                                                                        <div id="DIV_71">
                                                                        </div>
                                                                        <div id="DIV_72">
                                                                        </div>
                                                                    </div>
                                                                    <div id="DIV_73">
                                                                    </div>
                                                                    <div id="DIV_74">
                                                                    </div> -->
                                                        <input type="range" min="5" max="40" class="slider" id="rangeRateOfInterest"
                                                            data-bind="value: sliderRateofInterest, valueUpdate: 'input' ">
                                                    </div>
                                                    <input id="INPUT_75" type="text" value="5" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="DIV_76">
                            <div id="DIV_77">
                                <div id="DIV_78">
                                    <p id="P_79">
                                        Total Interest Payable
                                    </p>
                                    <h2 id="H2_80">
                                        Rs.417
                                    </h2>
                                </div>
                            </div>
                            <div id="DIV_81">
                                <div id="DIV_82">
                                    <p id="P_83">
                                        Total Payment (Principal + Interest)
                                    </p>
                                    <h2 id="H2_84">
                                        Rs.1,00,417
                                    </h2>
                                </div>
                            </div>
                            <div id="DIV_85">
                                <div id="DIV_86">
                                    <p id="P_87">
                                        Your EMI will be per month
                                    </p>
                                    <h2 id="H2_88">
                                        Rs.<span id="SPAN_89" data-bind="text : calculatedEMI,valueUpdate: 'input' ">N/A</span>
                                    </h2>
                                </div>
                            </div>
                        </div>
                        <div id="DIV_90">
                        </div>
                        <div id="DIV_91">
                            <a href="#" id="A_92"><button type="button" id="BUTTON_93">
                                    APPLY NOW
                                </button></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">

        var ViewModel = function () {
            var self = this;
            self.sliderLoanAmount = ko.observable(100000);

            //To show loan amount in multiple of 10000's
            self.sliderLoanAmountRounded = ko.computed(function () {
                let remainder = self.sliderLoanAmount() % 10000
                let roundedValue = self.sliderLoanAmount() - remainder
                roundedValue = convertValueToMoneyFormat(Math.round(roundedValue))
                return roundedValue
            }, this);
            self.sliderTenor = ko.observable(2);
            self.sliderRateofInterest = ko.observable(5);
            //self.SampleText=ko.observable("This is sample Text");
            //this.SliderLoanAmount= ko.observable("10");

            // Get variables in required formats
            // Convert interest from a percentage to a decimal, and convert from
            // an annual rate to a monthly rate.
            var principalAmount = Number(self.sliderLoanAmountRounded().replace(/[^0-9.-]+/g,""));
            var tenor = self.sliderTenor();
            var rateOfInterest = ((self.sliderRateofInterest()/100)/12);
             
            // self.EMI= ko.computed(calculateEMI(principalAmount,tenor,rateOfInterest));
            self.calculatedEMI= ko.computed( function(){
                // let x = Math.pow(1 + rateOfInterest, tenor);
                // let emiamt = (principalAmount*x*rateOfInterest)/(x-1);
                // return emiamt;
               // return 5;

               let x = Math.pow((1 + (self.sliderRateofInterest()/12)), self.sliderTenor());
               //alert('x:' + x.toString() + ' Loan Amount Rounded: ' + self.sliderLoanAmountRounded() + ' Tenor: ' + self.sliderTenor() + 'ROI:' + self.sliderRateofInterest());
                let emiamt = (Number(self.sliderLoanAmountRounded().replace(/[^0-9.-]+/g,""))*x*(self.sliderRateofInterest()/12))/(x-1);
                return emiamt;
            },this);

        };

        ko.applyBindings(new ViewModel(""));

        // EMI Calculation
        function calculateEMI(principalAmount,tenor,rateOfInterest) {
            let x = Math.pow(1 + rateOfInterest, tenor);
            let emi = (principalAmount*x*rateOfInterest)/(x-1);
            return emi;
        }
        //Total Payment calulation


        //Total interest calculation

        // function- 'convertValueToMoneyFormat' converts value in indian money format
        function convertValueToMoneyFormat(value) {
            var x = value;
            x = x.toString();
            var afterPoint = '';
            if (x.indexOf('.') > 0)
                afterPoint = x.substring(x.indexOf('.'), x.length);
            x = Math.floor(x);
            x = x.toString();
            var lastThree = x.substring(x.length - 3);
            var otherNumbers = x.substring(0, x.length - 3);
            if (otherNumbers != '')
                lastThree = ',' + lastThree;
            var res = otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g, ",") + lastThree + afterPoint;
            return res;
        }

    </script>
</body>

</html>